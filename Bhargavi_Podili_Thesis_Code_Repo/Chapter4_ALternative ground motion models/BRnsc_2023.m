function [T Sa] = BRnsc_2023(Mw, R, H, Sc)
%R, H in km;
%Sc is the site class: 
% Sc=0 for rock ground (Vs30 > 700m/s)
% Sc=1 for firm ground (375 < Vs30 ≤ 700m/s) 
% Sc=2 for soft soil (Vs30 ≤ 375m/s)
%Tpsha =[0 0.01 0.02 0.03 0.04 0.05 0.075 0.1 0.15 0.2 0.3 0.4 0.5 0.6 0.75 1.0 1.5 2 3 4 5 7.5 10];
mod1=[-2.1553	0.3725	-0.0142	0.008	-1.2476	0.096	-0.0159	-0.0012	0.1254	0.2401	0.2709
-2.1037	0.3611	-0.0134	0.008	-1.2586	0.097	-0.0165	-0.0012	0.1285	0.2381	0.2706
-1.8704	0.3042	-0.0093	0.0082	-1.2985	0.0998	-0.0174	-0.0012	0.1367	0.2339	0.2709
-1.2877	0.1426	0.0043	0.0082	-1.3161	0.0936	-0.0244	-0.001	0.1416	0.2387	0.2775
-0.8547	0.0242	0.0136	0.0086	-1.333	0.0918	-0.029	-0.001	0.1493	0.2438	0.2859
-0.6812	0.0268	0.0108	0.0091	-1.4342	0.104	-0.0381	-0.0009	0.1545	0.2402	0.2856
-0.6609	0.0833	0.0009	0.0096	-1.5225	0.1282	-0.0561	-0.0011	0.1393	0.2379	0.2757
-1.4056	0.3586	-0.0235	0.0093	-1.5072	0.1332	-0.0481	-0.0012	0.1117	0.2425	0.267
-2.3217	0.5647	-0.0363	0.0069	-1.176	0.1037	-0.0317	-0.0013	0.0939	0.2589	0.2754
-3.5755	0.9037	-0.0588	0.0055	-1.0124	0.0814	0.0009	-0.0013	0.101	0.2668	0.2853
-5.1401	1.2835	-0.0807	0.0065	-0.8937	0.0597	0.0378	-0.0013	0.1401	0.272	0.3059
-5.4789	1.2648	-0.0715	0.0039	-0.8183	0.0515	0.0403	-0.0014	0.167	0.279	0.3251
-6.1016	1.4414	-0.085	0.0022	-0.9163	0.0674	0.0402	-0.0014	0.1846	0.2829	0.3378
-6.2739	1.4173	-0.0769	0.002	-0.904	0.0585	0.0434	-0.0014	0.2015	0.2898	0.353
-6.8308	1.5258	-0.0827	0.0009	-0.9153	0.0585	0.079	-0.0014	0.2163	0.2975	0.3678
-7.2486	1.4786	-0.0702	0.0005	-0.7654	0.0389	0.0981	-0.0015	0.224	0.2918	0.3679
-7.557	1.3944	-0.0554	-0.0003	-0.714	0.03	0.1357	-0.0015	0.232	0.2988	0.3783
-7.5166	1.2898	-0.0421	-0.001	-0.6923	0.0163	0.1404	-0.0013	0.2411	0.3006	0.3853
-6.8503	0.8317	0.0067	-0.0002	-0.474	-0.0155	0.131	-0.0014	0.2565	0.3074	0.4003
-6.7459	0.592	0.0375	0.0002	-0.1043	-0.075	0.1274	-0.0014	0.2369	0.3262	0.4032
-6.26	0.3275	0.0587	0.0008	-0.0121	-0.0743	0.1162	-0.0015	0.226	0.3192	0.3911
-5.3781	-0.0772	0.0887	0.0015	0.0585	-0.0716	0.1012	-0.0015	0.2087	0.318	0.3804
-4.8567	-0.311	0.106	0.0025	0.1469	-0.082	0.07	-0.0015	0.1736	0.3179	0.3622];

mod2=[-3.7367	1.5818	-0.1464	-0.0037	-1.1612	0.1946	0.0247	-0.006	0.1111	0.2295	0.255
-3.7895	1.5942	-0.1473	-0.0038	-1.1506	0.1936	0.0252	-0.006	0.1112	0.2296	0.2551
-4.0357	1.6631	-0.1524	-0.0041	-1.1314	0.1927	0.0246	-0.006	0.1123	0.2312	0.2571
-4.5769	1.8535	-0.1691	-0.0054	-1.2331	0.2122	0.0262	-0.0062	0.1199	0.2362	0.2649
-4.9951	1.979	-0.1792	-0.0062	-1.2487	0.2176	0.0293	-0.0062	0.1224	0.2379	0.2676
-5.1592	1.9954	-0.178	-0.0077	-1.1442	0.2035	0.0333	-0.0063	0.1277	0.241	0.2728
-5.1559	1.9077	-0.1625	-0.0097	-0.6278	0.122	0.0484	-0.0062	0.144	0.2442	0.2835
-4.1265	1.4784	-0.1212	-0.0086	-0.1477	0.0485	0.041	-0.006	0.1559	0.2469	0.292
-2.8155	1.1381	-0.0964	-0.0056	-0.3053	0.0556	0.0289	-0.0059	0.1532	0.2426	0.2869
-1.3557	0.7832	-0.076	-0.0022	-0.9111	0.1407	0.0031	-0.0062	0.1379	0.2425	0.279
-0.5472	0.7295	-0.0857	-0.002	-1.8467	0.2769	-0.0156	-0.0063	0.1083	0.2477	0.2704
-0.7409	0.9172	-0.1095	0.0019	-2.2864	0.3358	-0.0059	-0.0062	0.0983	0.2508	0.2694
-0.1607	0.7722	-0.1009	0.0042	-2.4786	0.361	0.012	-0.0065	0.1004	0.2528	0.272
-0.466	0.9623	-0.1248	0.0057	-2.7275	0.4042	0.0122	-0.0062	0.1043	0.2586	0.2788
0.1343	0.803	-0.1147	0.0062	-2.7696	0.4115	-0.0068	-0.006	0.1108	0.2601	0.2827
-0.9281	1.2771	-0.1603	0.0096	-3.2123	0.4675	-0.0241	-0.0053	0.1177	0.2717	0.2961
-2.6806	1.9325	-0.2176	0.0116	-3.8589	0.5558	-0.0393	-0.0055	0.1324	0.2673	0.2983
-3.8277	2.1852	-0.2318	0.0097	-3.2108	0.4662	-0.0287	-0.0041	0.1466	0.2673	0.3048
-6.5957	2.9789	-0.2868	0.0076	-2.6333	0.359	-0.0218	-0.0012	0.1448	0.2604	0.298
-7.318	3.1081	-0.291	0.0054	-1.9929	0.2658	-0.0255	0.0001	0.1367	0.2561	0.2903
-7.5873	3.0548	-0.2729	0.0015	-1.2219	0.1362	-0.0093	0.001	0.1342	0.2666	0.2985
-6.734	2.5645	-0.2144	-0.0001	-0.006	-0.0669	-0.0064	0.0029	0.1609	0.2878	0.3297
-6.0098	2.3163	-0.1904	0.001	0.2498	-0.138	0.0162	0.0068	0.1658	0.2958	0.3391];

T =[0 0.01 0.02 0.03 0.04 0.05 0.075 0.1 0.15 0.2 0.3 0.4 0.5 0.6 0.75 1.0 1.5 2 3 4 5 7.5 10];

if R<=(40*(Mw-5.5))
    for k=1:23
        a0=mod1(k,1); a1=mod1(k,2); a2=mod1(k,3); a3=mod1(k,4); a4=mod1(k,5); a5=mod1(k,6); a6=mod1(k,7);
        a7=mod1(k,8); a8=mod1(k,9); a9=mod1(k,10); %a10=mod(k,11);
        %------------------
        SaHhim(k,1)= a0 + a1*Mw +a2*(Mw.^2)+ a3*H+(a4+ (a5.*(Mw)))*log10(sqrt((R.^2)+25))+ a6*Sc +a7.*R;
    end
    for k=1:23
        a0=mod2(k,1); a1=mod2(k,2); a2=mod2(k,3); a3=mod2(k,4); a4=mod2(k,5); a5=mod2(k,6); a6=mod2(k,7);
        a7=mod2(k,8); a8=mod2(k,9); a9=mod2(k,10); %a10=mod(k,11);
        %------------------
        SaHnsc(k,1)= a0 + a1*Mw +a2*(Mw.^2)+ a3*H+(a4+ (a5.*(Mw)))*log10(sqrt((R.^2)+25))+ a6*Sc +a7.*R;
    end
    SaH=SaHhim+SaHnsc;
else
    for k=1:23
        a0=mod1(k,1); a1=mod1(k,2); a2=mod1(k,3); a3=mod1(k,4); a4=mod1(k,5); a5=mod1(k,6); a6=mod1(k,7);
        a7=mod1(k,8); a8=mod1(k,9); a9=mod1(k,10); %a10=mod(k,11);
        %------------------
        SaH(k,1)= a0 + a1*Mw +a2*(Mw.^2)+ a3*H+(a4+ (a5.*(Mw)))*log10(sqrt((R.^2)+25))+ a6*Sc +a7.*R;
    end
end
Sa=10.^SaH;
end